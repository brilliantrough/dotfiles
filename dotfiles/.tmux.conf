### terminal color setting
# you need use "echo $TERM" first to decide which color you need to use
# set -g default-terminal "screen-256color"
set -g default-terminal "xterm-256color"
# set tmux to truecolor
set-option -ga terminal-overrides ",*256col*:Tc" 

### time(ms) to show the message bar
set -g display-time 3000
set -g escape-time 200
### disable window title auto-rename
setw -g automatic-rename off
### monitor window message
setw -g monitor-activity on
### tmux set
setw -g mode-keys vi    
set -g visual-activity on
### disable mouse
set -g mouse off
### set history limit
set-option -g history-limit 5000
set-option -g status-keys vi                         

# bind r source-file ~/.tmux.conf \; display "Reloaded!"

#-- bindkeys --#
# prefix key
set -g prefix ^t
# set -g prefix C-x
# set -g prefix M-x
# unbind ^b
unbind ^b
bind ^t send-prefix
# bind C-x send-prefix
# bind M-x send-prefix

# split window
# vertical split (prefix -)
unbind '"'
bind - splitw -v
# horizontal split (prefix |)
unbind %
bind | splitw -h 

# select pane
bind k selectp -U # above (prefix k)
bind j selectp -D # below (prefix j)
bind h selectp -L # left (prefix h)
bind l selectp -R # right (prefix l)

bind L select-window -l # switch window
bind W new-window
bind q select-window -p
bind e select-window -n


# resize pane
# bind -r M-k resizep -U 5 # upward (prefix Ctrl+k)
# bind -r M-j resizep -D 5 # downward (prefix Ctrl+j)
# bind -r M-h resizep -L 5 # to the left (prefix Ctrl+h)
# bind -r M-l resizep -R 5 # to the right (prefix Ctrl+l)

# swap pane
# swap with the previous pane (prefix Ctrl+u)
# bind ^u swapp -U
# swap with the next pane (prefix Ctrl+d)
# bind ^d swapp -D

# misc
# select the last pane (prefix e)
# bind e lastp
# select the last window (prefix Ctrl+e)
# bind ^e last
# kill pane (prefix q)
# bind q killp
# kill window (prefix Ctrl+q)
# bind ^q killw

# ERROR config, it will totally control w
# bind -n w new-window

# bind-key c new-window -c "#{pane_current_path}"
# bind-key % split-window -h -c "#{pane_current_path}"
# bind-key '"' split-window -c "#{pane_current_path}"

# bind ^z run "tmux-zoom"

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n 'C-h' if-shell "$is_vim" 'send-keys C-h'  'select-pane -L'
bind-key -n 'C-j' if-shell "$is_vim" 'send-keys C-j'  'select-pane -D'
bind-key -n 'C-k' if-shell "$is_vim" 'send-keys C-k'  'select-pane -U'
bind-key -n 'C-l' if-shell "$is_vim" 'send-keys C-l'  'select-pane -R'
tmux_version='$(tmux -V | sed -En "s/^tmux ([0-9]+(.[0-9]+)?).*/\1/p")'
if-shell -b '[ "$(echo "$tmux_version < 3.0" | bc)" = 1 ]' \
    "bind-key -n 'C-\\' if-shell \"$is_vim\" 'send-keys C-\\'  'select-pane -l'"
if-shell -b '[ "$(echo "$tmux_version >= 3.0" | bc)" = 1 ]' \
    "bind-key -n 'C-\\' if-shell \"$is_vim\" 'send-keys C-\\\\'  'select-pane -l'"

bind-key -T copy-mode-vi 'C-h' select-pane -L
bind-key -T copy-mode-vi 'C-j' select-pane -D
bind-key -T copy-mode-vi 'C-k' select-pane -U
bind-key -T copy-mode-vi 'C-l' select-pane -R
bind-key -T copy-mode-vi 'C-\' select-pane -l



